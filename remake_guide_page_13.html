<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<meta name="description" content="Section 12: Underground Facility exploration. Enrico encounter, boulder section, and Black Tiger boss.">
<meta property="og:type" content="website">
<meta property="og:title" content="Section 12: Underground Facility - REmake Speedrun Guide">
<meta property="og:description" content="Speedrun walkthrough section from the RE REmake guide.">
<meta property="og:image" content="https://remake.wheelofstruggle.com/Logos/THUMB_s3r30_remake.webp">
<meta property="og:url" content="https://remake.wheelofstruggle.com/remake_guide_page_13.html">
<meta name="twitter:card" content="summary_large_image">
<title>Section 12: Underground Facility - REmake Speedrun Guide</title>
<link rel="stylesheet" href="styles.css?v=5">
</head>
<body>
  <div class="fog-container"><div class="fog"></div></div>
  <div class="blood-drips" id="bloodDrips"></div>
  <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>

  <header class="header" id="header">
    <div class="header-content">
      <a href="index.html" class="logo">RESIDENT <span>EVIL</span></a>
      <div class="hamburger" id="hamburger" aria-label="Menu" role="button" tabindex="0"><span></span><span></span><span></span></div>
<nav class="nav">
        <a href="index.html">Home</a>
        <a href="remake_guide_page_1.html">Setup Guide</a>
        <div class="dropdown">
          <a href="remake_guide_page_2.html" class="dropdown-toggle">Walkthrough</a>
          <div class="dropdown-menu">
            <a href="remake_guide_page_2.html">Section 1: Mansion 1 - Opening</a>
            <a href="remake_guide_page_3.html">Section 2: Armour Key & Grenade Launcher</a>
            <a href="remake_guide_page_4.html">Section 3: Death Masks 2-4 & Yawn 1</a>
            <a href="remake_guide_page_5.html">Section 4: Gallery & Death Masks 3-4</a>
            <a href="remake_guide_page_6.html">Section 5: Elder Crimson Boss Fight</a>
            <a href="remake_guide_page_7.html">Section 6: Courtyard & Lisa's Hut</a>
            <a href="remake_guide_page_8.html">Section 7: Residence - Early</a>
            <a href="remake_guide_page_9.html">Section 8: Neptune & Aqua Ring</a>
            <a href="remake_guide_page_10.html">Section 9: Plant 42 Boss</a>
            <a href="remake_guide_page_11.html">Section 10: Mansion 2 - Hunter Navigation</a>
            <a href="remake_guide_page_12.html">Section 11: Yawn 2 & Gem Collection</a>
            <a href="remake_guide_page_13.html">Section 12: Underground Facility</a>
            <a href="remake_guide_page_14.html">Section 13: Lisa Trevor Underground</a>
            <a href="remake_guide_page_15.html">Section 14: Laboratory</a>
            <a href="remake_guide_page_16.html">Section 15: Tyrant & Helipad</a>
          </div>
        </div>
        <a href="resources-page.html">Resources</a>
        <a href="quick-reference-guide.html">Quick Reference</a>
        <span class="nav-disabled" data-tooltip="Postponed">StruggleR</span>
      </nav>
    </div>
  </header>

  <main>
    <div class="section-hero">
      <div class="section-badge">SECTION 12 OF 15</div>
      <h1 class="section-title">Underground Facility</h1>
      <div class="section-meta">
        <span>‚Ä¢</span>
        <span>CAVES</span>
        <span>‚Ä¢</span>
        <span>BLACK TIGER BOSS</span>
      </div>
    </div>

    <div class="content-grid">
      <aside class="sidebar">
        <div class="toc">
          <h3>Contents</h3>
          <ul>
            <li><a href="#objectives" class="active">Objectives</a></li>
            <li><a href="#caves-navigation">Navigation to Underground Caves</a></li>
            <li><a href="#enrico-encounter">Enrico Encounter</a></li>
            <li><a href="#boulder-room">Boulder Room</a></li>
            <li><a href="#black-tiger">Black Tiger Boss</a></li>
            <li><a href="#cylinder-puzzle">Cylinder Puzzle</a></li>
          </ul>

          <div class="section-nav">
            <h4>Navigate</h4>
            <a href="remake_guide_page_12.html" class="nav-link">‚Üê Section 11: Underground Access</a>
            <a href="remake_guide_page_14.html" class="nav-link">Section 13: Lisa Underground ‚Üí</a>
          </div>
        </div>
      </aside>

      <div class="main-content">
        <div class="objectives-box" id="objectives">
          <h3>Section Objectives</h3>
          <ul>
            <li>Navigate to Hex Crank and meet Enrico</li>
            <li>Complete boulder room puzzles</li>
            <li>Defeat Black Tiger boss fight</li>
            <li>Solve cylinder puzzle and enter code</li>
            <li>Prepare for Lisa Trevor underground encounters</li>
          </ul>
        </div>

        <div class="content-section" id="caves-navigation">
          <h2>Navigation to Underground Caves</h2>
          
          <p>Follow this route to reach the underground caves efficiently while avoiding unnecessary combat.</p>

          <h3>Roofed Passage ‚Üí Garden Shed ‚Üí Main Garden ‚Üí Water Pool</h3>
          
          <ul>
            <li>Follow the linear path through the passages.</li>
            <li>Dodge dogs in the Main Garden and snakes around the Water Pool.</li>
            <li>Take the elevator at the end of the Water Pool area.</li>
          </ul>

          <h3>Falls Area</h3>
          
          <ul>
            <li>Run opposite the waterfall and place the <strong style="color: var(--re-purple);">BATTERY</strong> in the battery hole.</li>
            <li>Ride the now‚Äëpowered elevator.</li>
          </ul>

          <h3>Main Garden / Water Pool</h3>
          
          <ul>
            <li>Dodge three dogs on the way into the water pool.</li>
            <li>Use the <strong style="color: var(--re-purple);">SQUARE CRANK</strong> to raise the water.</li>
            <li>Return to the Main Garden and take the elevator down, dodging dogs again.</li>
          </ul>

          <h3>Falls Area (Lower)</h3>
          
          <ul>
            <li>Head down the newly revealed ladder and keep moving to avoid dogs.</li>
          </ul>

          <h3>Entrance Passage</h3>
          
          <ul>
            <li>Go through the door next to the ladder.</li>
          </ul>

          <h3>Forked Passage</h3>
          
          <ul>
            <li>Move toward the light at the end, then turn right and exit via the door.</li>
          </ul>

          <h3>Generator Room</h3>
          
          <ul>
            <li>Go forward, then right, and exit via the door at the end of the corridor.</li>
          </ul>
        </div>
        <div class="content-section" id="enrico-encounter">
          <h2>Enrico Encounter</h2>
          
          <p>Proceed down the ladder into the underground caves. Navigate through the first door, heading toward the Hex Crank location.</p>

          <h3>Hex Crank Collection</h3>
          
          <ol>
            <li>Talk to Enrico in the caves</li>
            <li>Take the <strong>Hex Crank</strong> from him when he dies</li>
          </ol>

          <div class="info-box warning">
            <div class="info-box-title">Safety Save Option</div>
            <p>The boulder room ahead features an insta-kill mechanic. Considering how far you are into the game, you could save in the Caves just before activating the boulder. There is also a Green Herb by the door should you be low on health.</p>
          </div>
        </div>

        <div class="content-section" id="boulder-room">
          <h2>Boulder Room Puzzles</h2>
          
          <p>Use the Hex Crank on the wall mechanism to begin the boulder sequence.</p>

          <h3>First Boulder</h3>
          
          <ol>
            <li>Use the Hex Crank on the wall</li>
            <li>Get the boulder rolling</li>
            <li>Run out of the way to avoid being crushed</li>
            <li>Skip the cutscene</li>
            <li>Proceed to Black Tiger's room</li>
          </ol>

          <div class="danger-box">
            <h4>Boulder Instant Kill</h4>
            <p>The boulder is an instant kill with no mercy. If it touches you, it's Game Over. Make sure you're completely out of its path before it reaches your position.</p>
          </div>
        </div>

        <div class="content-section" id="black-tiger">
          <h2>Black Tiger Boss Fight</h2>
          
          <p>This boss fight requires quick reactions and proper positioning to avoid damage.</p>

          <h3>Advanced Strategy</h3>
          
          <p>Before regaining control of Jill, begin holding right on the analog stick to immediately run toward the web door.</p>

          <h4>Best RNG Outcome</h4>
          
          <ol>
            <li>Black Tiger will screech and lunge towards you</li>
            <li>As long as you keep moving to the right of the door, this can be avoided</li>
            <li>Move back towards the door</li>
            <li>Equip the Grenade Launcher</li>
            <li>Begin shooting at the webbed door.</li>
          </ol>

          <h4>Alternative Outcomes</h4>
          
          <p><strong>Slow Poison:</strong> Black Tiger will begin charging a poison (rumbling noise). Quickly equip the Grenade Launcher and blow off two webs with pump cancelling.</p>
          <p><strong>Quick Poison:</strong> Black Tiger will spit poison without charging. Continue running past the door to avoid the spray.</p>

          <div class="info-box success">
            <div class="info-box-title">Best RNG Bonus</div>
            <p>If you get the angle right and Black Tiger sprays you by the door, it can actually remove a web from the door for you. This is rare but saves a shell.</p>
          </div>

          <div class="info-box">
            <div class="info-box-title">Blue Herbs Available</div>
            <p>Good guy Capcom put Blue Herbs after a poison risk. Outside of Black Tiger's room are multiple Blue Herbs. You might want to take another on the way back if you're concerned about poison in later sections.</p>
          </div>

          <h3>Second Boulder</h3>
          
          <ol start="6">
            <li>Use the Hex Crank again to move the cave around</li>
            <li>This activates another boulder</li>
            <li>Run towards the boulder into the space this time (don't run away)</li>
          </ol>

          <div class="info-box success">
            <div class="info-box-title">Safety FAS Available</div>
            <p>There is a First Aid Spray where the boulder came from should you want a full heal before continuing.</p>
          </div>
        </div>

        <div class="content-section" id="cylinder-puzzle">
          <h2>Cylinder Puzzle</h2>
          
          <p>This is one of the most complex puzzles in the speedrun, requiring multiple statue pushes in a specific sequence.</p>

          <h3>Puzzle Solution</h3>
          
          <ol>
            <li>Enter the room and begin the Cylinder puzzle</li>
            <li>Push the statue up the wall 4 times</li>
            <li>Use the Hex Crank</li>
            <li>Push statue down once</li>
            <li>Push towards the centre spinner until it spins</li>
            <li>Push down twice</li>
            <li>Push towards the centre spinner until it spins again</li>
            <li>Push back towards the initial wall 3 times</li>
            <li>Push down until it locks in place and opens the wall compartment containing the Cylinder top</li>
          </ol>

          <div class="info-box warning">
            <div class="info-box-title">Complex Sequence</div>
            <p>This puzzle has many steps and it's easy to lose track. Practise the sequence multiple times or keep a reference handy. One wrong push can lose you alot of time.</p>
          </div>

          <h3>Cylinder Code Entry</h3>
          
          <ol start="10">
            <li>Go back through Black Tiger's room</li>
            <li>Return to the area before Enrico</li>
            <li>Grab the <strong>Cylinder shaft</strong></li>
            <li>Combine with Cylinder in your inventory</li>
            <li>Use the combined Cylinder on the mechanism</li>
            <li>Enter the code:</li>
          </ol>

          <div class="code-box">
            <div class="code-label">Cylinder Code</div>
            <div class="code-display">4231</div>
          </div>

          <div class="info-box">
            <div class="info-box-title">What's Next</div>
            <p>Section 14 covers the Lisa Trevor underground encounters. Lisa will spawn at specific locations and you'll need to navigate around her multiple times. This section also includes box puzzles and the compactor sequence to obtain the Broken Flamethrower.</p>
          </div>

          <h3>Practice Tips</h3>
          
          <p><strong>Boulder Timing:</strong> The boulders move at a consistent speed. Learn the safe zones and don't panic-run into walls or dead ends.</p>
          <p><strong>Black Tiger RNG:</strong> The best strategy is to immediately run right and stay mobile. Most of Black Tiger's attacks can be avoided with constant movement.</p>
          <p><strong>Cylinder Puzzle:</strong> Write down or memorise the sequence: Up 4, Crank, Down 1, Centre spin, Down 2, Centre spin, Back 3, Down to lock.</p>
        </div>

        <div class="page-nav">
          <a href="remake_guide_page_12.html" class="page-nav-btn">
            <span>‚Üê</span>
            <span>Section 11: Underground Access</span>
          </a>
          <a href="remake_guide_page_14.html" class="page-nav-btn">
            <span>Section 13: Lisa Underground</span>
            <span>‚Üí</span>
          </a>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Blood drip animation
    const bloodDripsContainer = document.getElementById('bloodDrips');
    for (let i = 0; i < 5; i++) {
      const drip = document.createElement('div');
      drip.className = 'blood-drip';
      drip.style.left = Math.random() * 100 + '%';
      drip.style.animationDelay = Math.random() * 3 + 's';
      drip.style.animationDuration = (Math.random() * 2 + 2) + 's';
      bloodDripsContainer.appendChild(drip);
    }

    window.addEventListener('scroll', () => {
      const winScroll = document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      document.getElementById('progressBar').style.width = (winScroll / height) * 100 + '%';
    });

    window.addEventListener('scroll', () => {
      const header = document.getElementById('header');
      header.classList.toggle('scrolled', window.scrollY > 100);
    });

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.toc a').forEach(link => link.classList.remove('active'));
          this.classList.add('active');
        }
      });
    });

    const sections = document.querySelectorAll('.content-section');
    const tocLinks = document.querySelectorAll('.toc a');

    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        if (scrollY >= section.offsetTop - 150) current = section.getAttribute('id');
      });

      tocLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) link.classList.add('active');
      });
    });
  

// Reset any horizontal scroll on page load (fixes iOS navigation issue)
window.scrollTo(0, 0);
document.documentElement.scrollLeft = 0;
document.body.scrollLeft = 0;

// Hamburger menu toggle
(function() {
  const hamburger = document.getElementById('hamburger');
  const nav = document.querySelector('.nav');
  
  if (hamburger && nav) {
    // Toggle menu
    hamburger.addEventListener('click', function(e) {
      e.stopPropagation();
      hamburger.classList.toggle('active');
      nav.classList.toggle('active');
      hamburger.setAttribute('aria-expanded', nav.classList.contains('active'));
    });
    
    // Close menu when clicking nav links (not dropdown toggles)
    nav.querySelectorAll('a:not(.dropdown-toggle)').forEach(function(link) {
      link.addEventListener('click', function() {
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
        // Also close any open dropdowns
        nav.querySelectorAll('.dropdown.open').forEach(function(d) {
          d.classList.remove('open');
        });
      });
    });
    
    // Dropdown toggle (don't close menu, just toggle dropdown)
    nav.querySelectorAll('.dropdown-toggle').forEach(function(toggle) {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        this.parentElement.classList.toggle('open');
      });
    });
    
    // Close dropdown when clicking dropdown menu links
    nav.querySelectorAll('.dropdown-menu a').forEach(function(link) {
      link.addEventListener('click', function() {
        // Close the dropdown
        this.closest('.dropdown').classList.remove('open');
        // Close the nav menu on mobile
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
      });
    });
    
    // Close menu and dropdowns when clicking outside
    document.addEventListener('click', function(e) {
      if (!nav.contains(e.target) && !hamburger.contains(e.target)) {
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
        nav.querySelectorAll('.dropdown.open').forEach(function(d) {
          d.classList.remove('open');
        });
      }
    });
    
    // Keyboard support (Escape to close)
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && nav.classList.contains('active')) {
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
        nav.querySelectorAll('.dropdown.open').forEach(function(d) {
          d.classList.remove('open');
        });
      }
    });
  }
})();

</script>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-info">
        <p>Original Guide by Deccyf</p>
        <p>¬© 2025 Wheel of Struggle Community Speedrun Guide ‚Ä¢ All Rights Reserved</p>
      </div>
      <div class="footer-buttons">
        <a href="https://discord.com/invite/8RVRE33WfN" class="footer-btn discord-btn" target="_blank">
          <img src="Logos/e5d0b9e74328b8ce389bd8dd7f4e56b0.webp" alt="Discord" class="footer-icon discord-logo" loading="lazy">
          Discord
        </a>
        <a href="https://wheelofstruggle.com" class="footer-btn website-btn" target="_blank">
          <img src="Logos/WoS_Discord_Colour_V2.webp" alt="Wheel of Struggle" class="footer-icon website-logo" loading="lazy">
          Website
        </a>
      </div>
    </div>
  </footer>
\n
  <script>
    // ENHANCED MUSIC CONTROL SYSTEM
    let backgroundMusic = null;
    let musicControlPanel = null;
    const musicFiles = ['01 R.E. 1 Save Room- Safe Haven.mp3'];

    function createMusicControl() {
      musicControlPanel = document.createElement('div');
      musicControlPanel.id = 'musicControlPanel';
      musicControlPanel.innerHTML = `
        <div class="music-control-header">
          <span class="music-icon">üéµ</span>
          <span class="music-title">Background Music</span>
          <button id="musicCloseBtn" class="music-close-btn">√ó</button>
        </div>
        <div class="music-control-content">
          <button id="musicToggleBtn" class="music-toggle-btn">
            <span id="musicToggleIcon">‚ñ∂Ô∏è</span>
            <span id="musicToggleText">Play</span>
          </button>
          <div class="music-volume-container">
            <span class="music-volume-label">Volume</span>
            <input type="range" id="musicVolumeSlider" min="0" max="100" value="30" class="music-volume-slider">
            <span id="musicVolumeValue">30</span>
          </div>
          <div class="music-status" id="musicStatus">Ready to play</div>
        </div>
      `;
      
      musicControlPanel.style.cssText = `
        position: fixed; bottom: 20px; right: 20px; width: 250px; background: rgba(13, 13, 13, 0.95);
        border: 2px solid var(--re-blood); border-radius: 15px; box-shadow: 0 8px 30px rgba(139, 0, 0, 0.4);
        backdrop-filter: blur(20px); z-index: 1000; opacity: 0; transform: translateY(20px);
        transition: all 0.3s ease; font-family: 'Barlow', sans-serif;
      `;

      const style = document.createElement('style');
      style.textContent = `
        .music-control-header { background: var(--re-blood); color: white; padding: 12px 15px;
          border-radius: 13px 13qx 0 0; display: flex; align-items: center; justify-content: space-between;
          font-weight: 700; font-size: 14px; }
        .music-icon { font-size: 16px; }
        .music-close-btn { background: none; border: none; color: white; font-size: 20px;
          cursor: pointer; padding: 0; width: 25px; height: 25px; border-radius: 50%;
          display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .music-close-btn:hover { background: rgba(255, 255, 255, 0.2); }
        .music-control-content { padding: 15px; }
        .music-toggle-btn { width: 100%; background: rgba(139, 0, 0, 0.2); border: 2px solid var(--re-blood);
          color: white; padding: 12px 15px; border-radius: 25px; cursor: pointer; display: flex;
          align-items: center; justify-content: center; gap: 8px; font-weight: 600; font-size: 14px;
          margin-bottom: 15px; transition: all 0.3s ease; }
        .music-toggle-btn:hover { background: var(--re-blood); transform: translateY(-2px);
          box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4); }
        .music-volume-container { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .music-volume-label { color: var(--re-gray); font-size: 12px; font-weight: 600; min-width: 50px; }
        .music-volume-slider { flex: 1; height: 6px; background: rgba(139, 0, 0, 0.3);
          border-radius: 3px; outline: none; cursor: pointer; }
        .music-volume-slider::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px;
          background: var(--re-blood); border-radius: 50%; cursor: pointer; box-shadow: 0 0 8px rgba(139, 0, 0, 0.6); }
        .music-volume-slider::-moz-range-thumb { width: 18px; height: 18px; background: var(--re-blood);
          border-radius: 50%; cursor: pointer; border: none; box-shadow: 0 0 8px rgba(139, 0, 0, 0.6); }
        #musicVolumeValue { color: var(--re-white); font-weight: 600; font-size: 12px; min-width: 30px; text-align: right; }
        .music-status { color: var(--re-gray); font-size: 11px; font-weight: 500; text-align: center;
          padding: 5px; background: rgba(139, 0, 0, 0.1); border-radius: 8px; margin-top: 10px; }
      `;
      document.head.appendChild(style);
      document.body.appendChild(musicControlPanel);
      
      setTimeout(() => { musicControlPanel.style.opacity = '1'; musicControlPanel.style.transform = 'translateY(0)'; }, 100);

      setupMusicControlEvents();
    }

    function setupMusicControlEvents() {
      document.getElementById('musicToggleBtn').addEventListener('click', toggleMusic);
      document.getElementById('musicVolumeSlider').addEventListener('input', updateVolume);
      document.getElementById('musicCloseBtn').addEventListener('click', hideMusicControl);
      document.getElementById('musicVolumeValue').textContent = document.getElementById('musicVolumeSlider').value;
      updateVolume();
    }

    function toggleMusic() {
      const toggleIcon = document.getElementById('musicToggleIcon');
      const toggleText = document.getElementById('musicToggleText');
      const status = document.getElementById('musicStatus');
      if (!backgroundMusic) { startBackgroundMusic(); toggleIcon.textContent = '‚è∏Ô∏è'; toggleText.textContent = 'Pause';
        status.textContent = 'Playing Resident Evil Theme'; status.style.color = 'var(--re-green)'; }
      else if (backgroundMusic.paused) { backgroundMusic.play(); toggleIcon.textContent = '‚è∏Ô∏è'; toggleText.textContent = 'Pause';
        status.textContent = 'Playing Resident Evil Theme'; status.style.color = 'var(--re-green)'; }
      else { backgroundMusic.pause(); toggleIcon.textContent = '‚ñ∂Ô∏è'; toggleText.textContent = 'Play';
        status.textContent = 'Music paused'; status.style.color = 'var(--re-gray)'; }
    }

    function updateVolume() {
      const volumeSlider = document.getElementById('musicVolumeSlider');
      const volumeValue = document.getElementById('musicVolumeValue');
      const volume = parseInt(volumeSlider.value) / 100;
      volumeValue.textContent = volumeSlider.value;
      if (backgroundMusic) backgroundMusic.volume = volume;
      localStorage.setItem('musicVolume', volumeSlider.value);
    }

    function startBackgroundMusic() {
      if (backgroundMusic) return;
      backgroundMusic = new Audio();
      backgroundMusic.src = musicFiles[0];
      backgroundMusic.loop = true;
      const savedVolume = localStorage.getItem('musicVolume') || '30';
      backgroundMusic.volume = parseInt(savedVolume) / 100;
      document.getElementById('musicVolumeSlider').value = savedVolume;
      document.getElementById('musicVolumeValue').textContent = savedVolume;
      backgroundMusic.play().then(() => {
        document.getElementById('musicStatus').textContent = 'Playing Resident Evil Theme';
        document.getElementById('musicStatus').style.color = 'var(--re-green)';
        document.getElementById('musicToggleIcon').textContent = '‚è∏Ô∏è';
        document.getElementById('musicToggleText').textContent = 'Pause';
      }).catch(() => {
        document.getElementById('musicStatus').textContent = 'Click play to start music';
        document.getElementById('musicStatus').style.color = 'var(--re-gray)';
      });
      backgroundMusic.addEventListener('ended', () => { backgroundMusic.currentTime = 0; backgroundMusic.play(); });
      backgroundMusic.addEventListener('error', (e) => {
        document.getElementById('musicStatus').textContent = 'Music file not found';
        document.getElementById('musicStatus').style.color = 'var(--re-blood)';
      });
    }

    function hideMusicControl() {
      if (musicControlPanel) {
        musicControlPanel.style.opacity = '0'; musicControlPanel.style.transform = 'translateY(20px)';
        setTimeout(() => { if (musicControlPanel && musicControlPanel.parentNode) musicControlPanel.parentNode.removeChild(musicControlPanel); musicControlPanel = null; }, 300);
      }
    }

    function showMusicControlButton() {
      const musicButton = document.createElement('div');
      musicButton.id = 'musicControlButton';
      musicButton.innerHTML = 'üéµ Music';
      musicButton.style.cssText = `position: fixed; bottom: 20px; right: 20px; background: rgba(139, 0, 0, 0.8);
        color: var(--re-white); padding: 12px 18px; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 600;
        z-index: 1000; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3); border: 2px solid rgba(139, 0, 0, 0.3);`;
      
      musicButton.addEventListener('mouseenter', () => { musicButton.style.background = 'var(--re-blood)'; musicButton.style.transform = 'scale(1.05)'; musicButton.style.boxShadow = '0 6px 20px rgba(139, 0, 0, 0.5)'; });
      musicButton.addEventListener('mouseleave', () => { musicButton.style.background = 'rgba(139, 0, 0, 0.8)'; musicButton.style.transform = 'scale(1)'; musicButton.style.boxShadow = '0 4px 15px rgba(139, 0, 0, 0.3)'; });
      musicButton.addEventListener('click', () => { createMusicControl(); musicButton.remove(); });
      document.body.appendChild(musicButton);
    }

    function initBackgroundMusic() {
      const musicInteracted = localStorage.getItem('musicInteracted') === 'true';
      if (!musicInteracted) {
        document.addEventListener('click', () => {
          localStorage.setItem('musicInteracted', 'true');
          document.getElementById('musicControlButton')?.remove();
          showMusicControlButton();
        }, { once: true });
      } else {
        showMusicControlButton();
      }
    }

    initBackgroundMusic();
    
    // MOBILE DROPDOWN NAVIGATION FIX
    (function() {
      const dropdown = document.querySelector('.dropdown');
      const dropdownToggle = document.querySelector('.dropdown-toggle');
      const dropdownMenu = document.querySelector('.dropdown-menu');
      if (!dropdown || !dropdownToggle || !dropdownMenu) return;
      function isMobile() { return window.innerWidth <= 768; }
      dropdownToggle.addEventListener('click', function(e) {
        if (isMobile()) { e.preventDefault(); e.stopPropagation(); dropdown.classList.toggle('open'); }
      });
      document.addEventListener('click', function(e) {
        if (isMobile() && !dropdown.contains(e.target)) dropdown.classList.remove('open');
      });
      dropdownMenu.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function() { if (isMobile()) dropdown.classList.remove('open'); });
      });
      let wasMobile = isMobile();
      window.addEventListener('resize', function() {
        const nowMobile = isMobile();
        if (wasMobile !== nowMobile) dropdown.classList.remove('open');
        wasMobile = nowMobile;
      });
    })();
  </script>\n<script src="toc-accordion.js"></script>
</body>
</html>
