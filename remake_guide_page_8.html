<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Section 7: Residence - Early - REmake Speedrun Guide</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Barlow:wght@300;400;500;600;700;800;900&family=Cinzel:wght@400;500;600;700;800;900&display=swap');
  
  * { margin: 0; padding: 0; box-sizing: border-box; }

  :root {
    --re-black: #0D0D0D; --re-dark: #1A1A1A; --re-blood: #8B0000;
    --re-crimson: #DC143C; --re-green: #7CFC00; --re-gold: #D4AF37;
    --re-white: #F5F5F5; --re-gray: #808080;
  }

  body {
    font-family: 'Barlow', sans-serif; background: var(--re-black);
    color: var(--re-white); line-height: 1.7; overflow-x: hidden;
  }

  .fog-container { position: fixed; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; z-index: -1; }
  
  .fog {
    position: absolute; width: 200%; height: 200%;
    background: radial-gradient(ellipse at 30% 40%, rgba(139, 0, 0, 0.15) 0%, transparent 40%),
                radial-gradient(ellipse at 70% 60%, rgba(124, 252, 0, 0.08) 0%, transparent 40%);
    animation: fogMove 30s ease-in-out infinite;
  }

  @keyframes fogMove {
    0%, 100% { transform: translate(0, 0); }
    25% { transform: translate(-5%, 5%); }
    50% { transform: translate(5%, -5%); }
    75% { transform: translate(-3%, 3%); }
  }

  .header {
    position: fixed; top: 0; left: 0; width: 100%; z-index: 1000;
    background: rgba(13, 13, 13, 0.95); backdrop-filter: blur(20px);
    border-bottom: 1px solid rgba(139, 0, 0, 0.3); transition: all 0.3s;
  }

  .header.scrolled { background: rgba(13, 13, 13, 0.98); box-shadow: 0 4px 30px rgba(139, 0, 0, 0.3); }

  .header-content {
    max-width: 1400px; margin: 0 auto; padding: 1.2rem 2rem;
    display: flex; justify-content: space-between; align-items: center;
  }

  .logo {
    font-family: 'Cinzel', serif; font-size: 1.8rem; font-weight: 700;
    color: var(--re-white); text-decoration: none; letter-spacing: 3px; position: relative;
  }

  .logo::before, .logo::after {
    content: ''; position: absolute; top: 50%; width: 20px; height: 2px;
    background: var(--re-blood); transform: translateY(-50%);
  }

  .logo::before { left: -30px; }
  .logo::after { right: -30px; }
  .logo span { color: var(--re-blood); }

  .nav { display: flex; gap: 3rem; align-items: center; }

  .nav a {
    color: var(--re-gray); text-decoration: none; font-weight: 600; font-size: 0.95rem;
    text-transform: uppercase; letter-spacing: 2px; transition: all 0.3s; position: relative;
  }

  .nav a::after {
    content: ''; position: absolute; bottom: -5px; left: 0; width: 0; height: 2px;
    background: var(--re-blood); transition: width 0.3s;
  }

  .nav a:hover { color: var(--re-white); }
  .nav a:hover::after { width: 100%; }

  .progress-bar {
    position: fixed; top: 73px; left: 0; width: 100%; height: 3px;
    background: rgba(139, 0, 0, 0.2); z-index: 999;
  }

  .progress-fill {
    height: 100%; background: linear-gradient(90deg, var(--re-blood), var(--re-crimson));
    width: 0%; transition: width 0.3s; box-shadow: 0 0 10px var(--re-blood);
  }

  main { padding-top: 100px; max-width: 1400px; margin: 0 auto; padding-left: 2rem; padding-right: 2rem; }

  .section-hero { text-align: center; padding: 4rem 0; position: relative; }

  .section-badge {
    display: inline-block; padding: 0.6rem 1.5rem; background: rgba(139, 0, 0, 0.2);
    border: 1px solid var(--re-blood); border-radius: 30px; font-size: 0.85rem;
    font-weight: 700; text-transform: uppercase; letter-spacing: 3px;
    color: var(--re-green); margin-bottom: 1.5rem; animation: pulse 2s ease-in-out infinite;
  }

  @keyframes pulse {
    0%, 100% { box-shadow: 0 0 10px rgba(124, 252, 0, 0.3); }
    50% { box-shadow: 0 0 20px rgba(124, 252, 0, 0.6); }
  }

  .section-title {
    font-family: 'Cinzel', serif; font-size: 3.5rem; font-weight: 900; margin-bottom: 1rem;
    line-height: 1.1; letter-spacing: 3px;
    text-shadow: 0 0 20px rgba(139, 0, 0, 0.5), 0 0 40px rgba(139, 0, 0, 0.3);
    animation: titleGlow 3s ease-in-out infinite;
  }

  @keyframes titleGlow {
    0%, 100% { text-shadow: 0 0 20px rgba(139, 0, 0, 0.5), 0 0 40px rgba(139, 0, 0, 0.3); }
    50% { text-shadow: 0 0 30px rgba(139, 0, 0, 0.8), 0 0 60px rgba(139, 0, 0, 0.5); }
  }

  .section-meta {
    display: flex; gap: 3rem; justify-content: center;
    color: var(--re-gray); font-size: 0.95rem; margin-top: 1.5rem;
  }

  .content-grid { display: grid; grid-template-columns: 250px 1fr; gap: 3rem; margin-top: 4rem; }
  .sidebar { position: sticky; top: 120px; height: fit-content; }

  .toc {
    background: rgba(26, 26, 26, 0.6); backdrop-filter: blur(10px);
    border: 1px solid rgba(139, 0, 0, 0.3); border-radius: 15px; padding: 2rem;
  }

  .toc h3 {
    font-family: 'Cinzel', serif; font-size: 1.2rem; margin-bottom: 1.5rem;
    color: var(--re-blood); letter-spacing: 2px;
  }

  .toc ul { list-style: none; }
  .toc li { margin-bottom: 0.8rem; }

  .toc a {
    color: var(--re-gray); text-decoration: none; font-size: 0.95rem;
    transition: all 0.3s; display: block; padding: 0.5rem; border-radius: 5px;
    position: relative; padding-left: 1.5rem;
  }

  .toc a::before { content: '‚ñ∏'; position: absolute; left: 0.5rem; opacity: 0; transition: all 0.3s; }
  .toc a:hover { color: var(--re-white); background: rgba(139, 0, 0, 0.2); padding-left: 2rem; }
  .toc a:hover::before { opacity: 1; }
  .toc a.active { color: var(--re-blood); background: rgba(139, 0, 0, 0.2); }

  .section-nav { margin-top: 2rem; padding-top: 2rem; border-top: 1px solid rgba(139, 0, 0, 0.3); }

  .section-nav h4 {
    font-size: 0.85rem; color: var(--re-gray); text-transform: uppercase;
    letter-spacing: 2px; margin-bottom: 1rem;
  }

  .nav-link {
    display: block; color: var(--re-gray); text-decoration: none; padding: 0.5rem;
    border-radius: 5px; margin-bottom: 0.5rem; transition: all 0.3s;
  }

  .nav-link:hover { color: var(--re-gold); background: rgba(212, 175, 55, 0.1); }

  .main-content {
    background: rgba(26, 26, 26, 0.6); backdrop-filter: blur(10px);
    border: 1px solid rgba(139, 0, 0, 0.2); border-radius: 15px; padding: 3rem;
  }

  .objectives-box {
    background: rgba(212, 175, 55, 0.1); border: 2px solid var(--re-gold);
    border-radius: 15px; padding: 2rem; margin-bottom: 3rem; position: relative; overflow: hidden;
  }

  .objectives-box::before {
    content: ''; position: absolute; top: -50%; left: -50%; width: 200%; height: 200%;
    background: radial-gradient(circle, rgba(212, 175, 55, 0.1), transparent);
    animation: rotate 20s linear infinite;
  }

  @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

  .objectives-box h3 {
    font-family: 'Cinzel', serif; color: var(--re-gold); margin-bottom: 1.5rem;
    font-size: 1.5rem; position: relative; z-index: 2;
  }

  .objectives-box ul { list-style: none; position: relative; z-index: 2; }

  .objectives-box li {
    padding: 0.8rem 0; padding-left: 2rem; position: relative;
    color: var(--re-gray); transition: all 0.3s;
  }

  .objectives-box li::before {
    content: '‚úì'; position: absolute; left: 0; color: var(--re-gold);
    font-weight: 700; font-size: 1.2rem;
  }

  .objectives-box li:hover { color: var(--re-white); padding-left: 2.5rem; }

  .content-section { margin-bottom: 3rem; animation: fadeIn 0.8s ease-out; }

  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .content-section h2 {
    font-family: 'Cinzel', serif; font-size: 2.2rem; color: var(--re-blood);
    margin-bottom: 1.5rem; padding-bottom: 1rem; border-bottom: 2px solid rgba(139, 0, 0, 0.3);
    position: relative;
  }

  .content-section h2::after {
    content: ''; position: absolute; bottom: -2px; left: 0;
    width: 100px; height: 2px; background: var(--re-blood);
  }

  .content-section h3 {
    font-family: 'Cinzel', serif; font-size: 1.5rem;
    color: var(--re-white); margin: 2rem 0 1rem 0;
  }

  .content-section p { color: var(--re-gray); line-height: 1.8; margin-bottom: 1.5rem; font-size: 1.05rem; }
  .content-section ol { margin-left: 2rem; margin-bottom: 1.5rem; }
  .content-section li { color: var(--re-gray); margin-bottom: 1rem; line-height: 1.8; }
  .content-section strong { color: var(--re-gold); }

  .mask-order {
    background: rgba(212, 175, 55, 0.1); border: 2px solid var(--re-gold);
    border-radius: 15px; padding: 2rem; margin: 2rem 0;
  }

  .mask-order h4 {
    font-family: 'Cinzel', serif; color: var(--re-gold);
    margin-bottom: 1.5rem; font-size: 1.3rem;
  }

  .mask-list { display: grid; gap: 0.75rem; }

  .mask-item {
    background: rgba(26, 26, 26, 0.8); padding: 1rem; border-radius: 8px;
    display: flex; align-items: center; gap: 1rem; transition: all 0.3s;
  }

  .mask-item:hover { transform: translateX(5px); background: rgba(139, 0, 0, 0.2); }

  .mask-number {
    background: var(--re-blood); color: white; width: 40px; height: 40px;
    border-radius: 50%; display: flex; align-items: center; justify-content: center;
    font-weight: bold; font-size: 1.2rem; flex-shrink: 0;
  }

  .rng-outcomes {
    background: rgba(26, 26, 26, 0.8); border: 1px solid rgba(139, 0, 0, 0.3);
    border-radius: 10px; padding: 2rem; margin: 2rem 0;
  }

  .rng-outcomes h4 {
    font-family: 'Cinzel', serif; color: var(--re-blood);
    margin-bottom: 1.5rem; font-size: 1.3rem;
  }

  .rng-item {
    background: rgba(139, 0, 0, 0.1); padding: 1rem; border-radius: 8px;
    margin-bottom: 1rem; border-left: 3px solid var(--re-gray);
    transition: all 0.3s;
  }

  .rng-item:hover { transform: translateX(5px); }
  .rng-item.best { border-left-color: var(--re-green); }
  .rng-item.worst { border-left-color: var(--re-blood); }
  .rng-item strong { color: var(--re-gold); }

  .info-box {
    background: rgba(139, 0, 0, 0.1); border-left: 4px solid var(--re-blood);
    padding: 1.5rem; border-radius: 10px; margin: 2rem 0;
    position: relative; overflow: hidden;
  }

  .info-box::before {
    content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
    background: linear-gradient(90deg, rgba(139, 0, 0, 0.1), transparent);
    animation: shimmer 3s infinite;
  }

  @keyframes shimmer {
    0%, 100% { transform: translateX(-100%); }
    50% { transform: translateX(100%); }
  }

  .info-box-title {
    font-weight: 700; color: var(--re-blood); margin-bottom: 0.8rem;
    font-size: 1.1rem; letter-spacing: 1px; position: relative; z-index: 2;
  }

  .info-box p, .info-box ul { position: relative; z-index: 2; }

  .info-box.warning { border-left-color: var(--re-gold); background: rgba(212, 175, 55, 0.1); }
  .info-box.warning .info-box-title { color: var(--re-gold); }

  .page-nav {
    display: flex; justify-content: space-between; margin-top: 4rem;
    padding-top: 3rem; border-top: 2px solid rgba(139, 0, 0, 0.3);
  }

  .page-nav-btn {
    display: inline-flex; align-items: center; gap: 1rem; padding: 1.2rem 2.5rem;
    background: rgba(139, 0, 0, 0.2); border: 2px solid var(--re-blood); border-radius: 50px;
    color: var(--re-white); text-decoration: none; font-weight: 700;
    text-transform: uppercase; letter-spacing: 2px; transition: all 0.4s;
    position: relative; overflow: hidden;
  }

  .page-nav-btn::before {
    content: ''; position: absolute; top: 50%; left: 50%; width: 0; height: 0;
    border-radius: 50%; background: rgba(139, 0, 0, 0.3);
    transform: translate(-50%, -50%); transition: width 0.6s, height 0.6s;
  }

  .page-nav-btn:hover::before { width: 300px; height: 300px; }
  .page-nav-btn:hover { transform: translateY(-3px); box-shadow: 0 10px 40px rgba(139, 0, 0, 0.5); }

  @media (max-width: 968px) {
    .content-grid { grid-template-columns: 1fr; }
    .sidebar { position: static; }
    .section-title { font-size: 2.5rem; }
    .nav { gap: 1.5rem; }
  }

  .blood-drips {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  .blood-drip {
    position: absolute;
    width: 2px;
    height: 0;
    background: linear-gradient(180deg, transparent, var(--re-blood));
    animation: drip 3s ease-in infinite;
  }

  @keyframes drip {
    0% { height: 0; opacity: 0; }
    10% { opacity: 1; }
    100% { height: 100vh; opacity: 0; }
  }

  .footer {
    background: rgba(13, 13, 13, 0.95);
    border-top: 1px solid rgba(139, 0, 0, 0.3);
    padding: 3rem 2rem;
    text-align: center;
    margin-top: 8rem;
  }

  .footer p {
    color: var(--re-gray);
    font-size: 0.9rem;
    margin-bottom: 0.5rem;
  }

  .footer-content {
    max-width: 1400px;
    margin: 0 auto;
    display: flex;
    justify-content: space-between;
    align-items: center;
    gap: 2rem;
  }

  .footer-info {
    text-align: left;
  }

  .footer-buttons {
    display: flex;
    gap: 1rem;
  }

  .footer-btn {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    padding: 0.75rem 1.5rem;
    border-radius: 25px;
    text-decoration: none;
    font-weight: 600;
    font-size: 0.9rem;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .discord-btn {
    background: rgba(88, 101, 242, 0.2);
    color: #5865f2;
    border: 1px solid rgba(88, 101, 242, 0.3);
  }

  .discord-btn:hover {
    background: #5865f2;
    color: var(--re-white);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(88, 101, 242, 0.4);
  }

  .website-btn {
    background: rgba(139, 0, 0, 0.2);
    color: var(--re-blood);
    border: 1px solid rgba(139, 0, 0, 0.3);
  }

  .website-btn:hover {
    background: var(--re-blood);
    color: var(--re-white);
    transform: translateY(-2px);
    box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4);
  }

  .footer-icon {
    font-size: 1.1rem;
  }

  .discord-logo {
    width: 20px;
    height: 20px;
    vertical-align: middle;
    margin-right: 0.5rem;
  }

  .website-logo {
    width: 20px;
    height: 20px;
    vertical-align: middle;
    margin-right: 0.5rem;
    filter: brightness(1.2);
  }

  @media (max-width: 768px) {
    .footer-content {
      flex-direction: column;
      gap: 1.5rem;
    }
    .footer-info {
      text-align: center;
    }
    .footer-buttons {
      justify-content: center;
    }
  }
/* Nav hover dropdown */
.dropdown { position: relative; }
.dropdown-toggle { display: inline-block; }
.dropdown-menu {
  display: none;
  position: absolute;
  top: 100%;
  left: 0;
  min-width: 320px;
  background: rgba(26, 26, 26, 0.98);
  border: 1px solid rgba(139, 0, 0, 0.4);
  border-radius: 8px;
  padding: 0.5rem 0;
  box-shadow: 0 10px 30px rgba(0,0,0,0.5);
  z-index: 1001;
}
/* Only enable hover on desktop devices with mouse */
@media (hover: hover) and (pointer: fine) {
  .dropdown:hover .dropdown-menu { display: block; }
}
.dropdown-menu a {
  display: block;
  padding: 0.6rem 1rem;
  color: var(--re-gray);
  text-decoration: none;
  font-weight: 600;
  letter-spacing: 1px;
  white-space: nowrap;
}
.dropdown-menu a:hover { background: rgba(139,0,0,0.2); color: var(--re-white); }


  /* ==================================================
     MOBILE RESPONSIVE DESIGN
     ================================================== */
  
  /* Medium screens (tablets) */
  @media (max-width: 1024px) {
    .container { 
      max-width: 95%; 
      padding: 0 1.5rem;
    }
    
    .guide-content {
      padding: 0 1rem;
    }
    
    .guide-section {
      margin-bottom: 3rem;
    }
  }

  /* Small screens (mobile landscape) */
  @media (max-width: 768px) {
    .container { 
      max-width: 95%; 
      padding: 0 1rem;
    }
    
    body {
      background-attachment: scroll !important;
    }
    
    .header-content {
      padding: 1rem;
      flex-direction: column;
      gap: 1rem;
    }
    
    .logo {
      font-size: 1.4rem;
      letter-spacing: 2px;
    }
    
    .nav {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 0.5rem;
      width: 100%;
      max-width: 400px;
    }
    
    .nav a {
      padding: 0.6rem 0.8rem;
      font-size: 0.8rem;
      text-align: center;
      border: 1px solid rgba(139, 0, 0, 0.3);
      border-radius: 8px;
      background: rgba(139, 0, 0, 0.1);
      min-height: 44px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    /* CRITICAL FIX: Dropdown navigation for mobile */
    .dropdown { grid-column: 1 / -1; display: block; }
    .dropdown-toggle { width: 100%; padding: 0.6rem 0.8rem; font-size: 0.8rem; text-align: center; border: 1px solid rgba(139, 0, 0, 0.3); border-radius: 8px; background: rgba(139, 0, 0, 0.1); min-height: 44px; display: flex; align-items: center; justify-content: center; cursor: pointer; position: relative; }
    .dropdown-toggle::after { content: ' ‚ñº'; font-size: 0.7rem; margin-left: 0.5rem; transition: transform 0.3s; }
    .dropdown.open .dropdown-toggle::after { transform: rotate(180deg); }
    .dropdown-menu { display: none !important; position: static !important; width: 100%; margin-top: 0.5rem; max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: rgba(13, 13, 13, 0.95); border-radius: 8px; padding: 0; }
    .dropdown.open .dropdown-menu { display: block !important; max-height: 800px; padding: 0.5rem 0; overflow-y: auto; }
    .dropdown-menu a { font-size: 0.75rem; padding: 0.7rem 1rem; border-bottom: 1px solid rgba(139, 0, 0, 0.2); white-space: normal; line-height: 1.4; }
    .dropdown-menu a:last-child { border-bottom: none; }
    
    main {
      padding-top: 120px;
      padding-left: 0;
      padding-right: 0;
    }
    
    .content-grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
      padding: 0 1rem;
    }
    
    .sidebar {
      position: static;
      order: 2;
      width: 100%;
      padding: 1rem;
    }
    
    .main-content {
      padding: 1rem;
      order: 1;
      width: 100%;
    }
    
    .section-title {
      font-size: 2rem !important;
      margin-bottom: 2rem;
      text-align: center;
    }
    
    .content-section {
      margin-bottom: 2.5rem;
    }
    
    .content-section h2 {
      font-size: 1.5rem;
      margin-bottom: 1rem;
    }
    
    .content-section h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
    }
    
    .content-section p {
      margin-bottom: 1rem;
      font-size: 0.9rem;
      line-height: 1.6;
    }
    
    .content-section ul, ol {
      margin: 1rem 0;
      padding-left: 1.5rem;
    }
    
    .content-section li {
      margin-bottom: 0.5rem;
      font-size: 0.9rem;
    }
    
    /* Objectives box mobile fix */
    .objectives-box {
      padding: 1.5rem;
      margin-bottom: 2rem;
    }
    
    .objectives-box h3 {
      font-size: 1.3rem;
      margin-bottom: 1rem;
    }
    
    .objectives-box li {
      padding: 0.6rem 0;
      padding-left: 1.5rem;
      font-size: 0.9rem;
    }
    
    .objectives-box li::before {
      content: '‚úì';
      position: absolute;
      left: 0;
      color: var(--re-gold);
      font-weight: 700;
      font-size: 1rem;
    }
    
    /* Info boxes mobile */
    .info-box {
      padding: 1rem;
      margin: 1.5rem 0;
    }
    
    .info-box-title {
      font-size: 1rem;
      margin-bottom: 0.6rem;
    }
    
    /* Page navigation mobile */
    .page-nav {
      flex-direction: column;
      gap: 1rem;
      margin-top: 3rem;
    }
    
    .page-nav-btn {
      padding: 1rem 1.5rem;
      font-size: 0.9rem;
      text-align: center;
    }
    
    /* Tablets */
    .guide-table {
      width: 100%;
      overflow-x: auto;
      display: block;
      white-space: nowrap;
      margin: 1.5rem 0;
    }
    
    .guide-table table {
      min-width: 500px;
      width: 100%;
    }
    
    /* Code blocks */
    .code-block {
      font-size: 0.8rem;
      padding: 1rem;
      margin: 1rem 0;
      overflow-x: auto;
    }
    
    /* Footer adjustments */
    .footer-content {
      flex-direction: column;
      gap: 1.5rem;
      text-align: center;
      padding: 2rem 1rem;
    }
    
    .footer-buttons {
      flex-direction: column;
      gap: 0.8rem;
      align-items: center;
    }

    /* Music control for mobile */
    .music-control-panel {
      width: 90vw !important;
      max-width: 300px !important;
      bottom: 80px !important;
      right: 5vw !important;
    }
    
    #musicControlButton {
      bottom: 15px !important;
      right: 15px !important;
      padding: 10px 15px !important;
      font-size: 12px !important;
    }
  }

  /* Very small screens (mobile portrait) */
  @media (max-width: 480px) {
    .container {
      padding: 0 0.8rem;
      max-width: 100%;
    }
    
    .header-content {
      padding: 0.8rem 0.5rem;
    }
    
    .logo {
      font-size: 1.2rem;
      letter-spacing: 1px;
    }
    
    .nav {
      grid-template-columns: 1fr;
      gap: 0.3rem;
    }
    
    .nav a {
      padding: 0.5rem 0.6rem;
      font-size: 0.75rem;
    }
    
    main {
      padding-top: 140px;
      padding-left: 0;
      padding-right: 0;
    }
    
    .content-grid {
      gap: 1rem;
      padding: 0 0.5rem;
    }
    
    .main-content {
      padding: 0.5rem;
    }
    
    .sidebar {
      padding: 0.5rem;
    }
    
    .section-title {
      font-size: 1.5rem !important;
      margin-bottom: 1.5rem;
      text-align: center;
    }
    
    .content-section {
      margin-bottom: 2rem;
    }
    
    .content-section h2 {
      font-size: 1.3rem;
      margin-bottom: 0.8rem;
    }
    
    .content-section h3 {
      font-size: 1.2rem;
      margin-bottom: 0.8rem;
    }
    
    .content-section p {
      margin-bottom: 0.8rem;
      font-size: 0.85rem;
      line-height: 1.5;
    }
    
    .content-section ul, ol {
      margin: 0.8rem 0;
      padding-left: 1.25rem;
    }
    
    .content-section li {
      margin-bottom: 0.4rem;
      font-size: 0.85rem;
    }
    
    /* Objectives box mobile portrait */
    .objectives-box {
      padding: 1rem;
      margin-bottom: 1.5rem;
    }
    
    .objectives-box h3 {
      font-size: 1.1rem;
      margin-bottom: 0.8rem;
    }
    
    .objectives-box li {
      padding: 0.5rem 0;
      padding-left: 1.2rem;
      font-size: 0.85rem;
    }
    
    .objectives-box li::before {
      font-size: 0.9rem;
    }
    
    /* Info boxes mobile portrait */
    .info-box {
      padding: 0.8rem;
      margin: 1rem 0;
    }
    
    .info-box-title {
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }
    
    /* Page navigation mobile portrait */
    .page-nav-btn {
      padding: 0.8rem 1rem;
      font-size: 0.8rem;
    }
    
    /* Large buttons for touch */
    .btn, .step-number {
      min-height: 44px;
      min-width: 44px;
      padding: 0.8rem 1rem;
      font-size: 0.85rem;
    }
    
    /* Tables - horizontal scroll */
    .guide-table {
      font-size: 0.8rem;
      margin: 1rem 0;
    }
    
    .guide-table th,
    .guide-table td {
      padding: 0.5rem 0.3rem;
      white-space: nowrap;
    }
    
    /* Code blocks */
    .code-block {
      font-size: 0.75rem;
      padding: 0.8rem;
      margin: 0.8rem 0;
    }
    
    /* Images */
    img {
      max-width: 100%;
      height: auto;
    }
    
    /* Footer */
    .footer-content {
      padding: 1.5rem 0.5rem;
    }
    
    .footer-btn {
      padding: 0.8rem 1.2rem;
      font-size: 0.8rem;
    }
    
    /* Warning boxes */
    .warning-box,
    .critical-sequence,
    .urgent-warning {
      padding: 1rem;
      margin: 1rem 0;
      font-size: 0.85rem;
    }
    
    .warning-box h4,
    .critical-sequence h3,
    .urgent-warning h3 {
      font-size: 1.1rem;
      margin-bottom: 0.8rem;
    }
  }

  /* Ultra small screens */
  @media (max-width: 320px) {
    .nav a { 
      padding: 0.3rem 0.4rem; 
      font-size: 0.7rem; 
    }
    
    .guide-content {
      padding: 1rem 0.3rem;
      font-size: 0.8rem;
    }
    
    .section-title {
      font-size: 1.3rem !important;
    }
  }

  /* Touch device improvements */
  @media (hover: none) and (pointer: coarse) {
    .btn:hover,
    .nav a:hover,
    .quick-link-item:hover {
      transform: none !important;
    }
    
    .btn:active {
      background: rgba(139, 0, 0, 0.8) !important;
      transform: scale(0.98);
    }
  }

  /* Landscape orientation on phones */
  @media (max-height: 600px) and (orientation: landscape) {
    .guide-content {
      padding: 1rem 0.5rem;
    }
    
    .section-title {
      font-size: 1.5rem !important;
      margin-bottom: 1rem;
    }
    
    .guide-section {
      margin-bottom: 1.5rem;
    }
    
    .guide-section h3 {
      font-size: 1.1rem;
    }
  }

  /* Print styles */
  @media print {
    .header, .footer, #musicControlButton, .music-control-panel {
      display: none !important;
    }
    
    .guide-content {
      padding: 0;
      font-size: 12pt;
    }
    
    body {
      background: white !important;
      color: black !important;
    }
  }\n
/* HAMBURGER MENU */
.hamburger {
  display: none;
}

@media (max-width: 768px) {
  .hamburger {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    width: 44px;
    height: 44px;
    background: rgba(139, 0, 0, 0.2);
    border: 1px solid rgba(139, 0, 0, 0.4);
    border-radius: 8px;
    cursor: pointer;
    position: absolute;
    right: 1rem;
    top: 50%;
    transform: translateY(-50%);
    z-index: 1001;
  }
  
  .hamburger span {
    display: block;
    width: 24px;
    height: 3px;
    background: var(--re-white);
    margin: 2px 0;
    transition: all 0.3s ease;
    border-radius: 1px;
  }
  
  .hamburger.active span:nth-child(1) {
    transform: rotate(45deg) translate(6px, 6px);
  }
  
  .hamburger.active span:nth-child(2) {
    opacity: 0;
  }
  
  .hamburger.active span:nth-child(3) {
    transform: rotate(-45deg) translate(6px, -6px);
  }
  
  .header-content {
    position: relative;
  }
  
  .nav {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    background: rgba(13, 13, 13, 0.98);
    backdrop-filter: blur(10px);
    z-index: 1000;
    display: flex;
    flex-direction: column;
    padding: 70px 2rem 2rem;
    gap: 0;
    transform: translateX(100%);
    transition: transform 0.3s ease;
  }
  
  .nav.active {
    transform: translateX(0);
  }
  
  .nav a {
    width: 100%;
    padding: 1rem 0;
    font-size: 1.1rem;
    text-align: left;
    border-bottom: 1px solid rgba(139, 0, 0, 0.2);
    background: transparent;
    min-height: 48px;
    display: flex;
    align-items: center;
  }
  
  .nav a:last-child {
    border-bottom: none;
  }
  
  .dropdown-menu {
    position: static;
    display: none;
    background: transparent;
    padding: 0 0 0 1rem;
    opacity: 1;
    visibility: visible;
  }
  
  .dropdown.open .dropdown-menu {
    display: block;
  }
}

</style>
</head>
<body>
  <div class="fog-container"><div class="fog"></div></div>
  <div class="blood-drips" id="bloodDrips"></div>
  <div class="progress-bar"><div class="progress-fill" id="progressBar"></div></div>

  <header class="header" id="header">
    <div class="header-content">
      <a href="index.html" class="logo">RESIDENT <span>EVIL</span></a>
      <div class="hamburger" id="hamburger" aria-label="Menu" role="button" tabindex="0"><span></span><span></span><span></span></div>
<nav class="nav">
        <a href="index.html">Home</a>
        <a href="remake_guide_page_1.html">Setup Guide</a>
        <div class="dropdown">
          <a href="remake_guide_page_2.html" class="dropdown-toggle">Walkthrough</a>
          <div class="dropdown-menu">
            <a href="remake_guide_page_2.html">Section 1: Mansion 1 - Opening</a>
            <a href="remake_guide_page_3.html">Section 2: Armour Key & Grenade Launcher</a>
            <a href="remake_guide_page_4.html">Section 3: Death Masks 2-4 & Yawn 1</a>
            <a href="remake_guide_page_5.html">Section 4: Gallery & Death Masks 3-4</a>
            <a href="remake_guide_page_6.html">Section 5: Elder Crimson Boss Fight</a>
            <a href="remake_guide_page_7.html">Section 6: Courtyard & Lisa's Hut</a>
            <a href="remake_guide_page_8.html">Section 7: Residence - Early</a>
            <a href="remake_guide_page_9.html">Section 8: Neptune & Aqua Ring</a>
            <a href="remake_guide_page_10.html">Section 9: Plant 42 Boss</a>
            <a href="remake_guide_page_11.html">Section 10: Mansion 2 - Hunter Navigation</a>
            <a href="remake_guide_page_12.html">Section 11: Yawn 2 & Gem Collection</a>
            <a href="remake_guide_page_13.html">Section 12: Underground Facility</a>
            <a href="remake_guide_page_14.html">Section 13: Lisa Trevor Underground</a>
            <a href="remake_guide_page_15.html">Section 14: Laboratory</a>
            <a href="remake_guide_page_16.html">Section 15: Tyrant & Helipad</a>
          </div>
        </div>
        <a href="resources-page.html">Resources</a>
        <a href="quick-reference-guide.html">Quick Reference</a>
        <a href="struggler_info_page.html">StruggleR</a>
      </nav>
    </div>
  </header>

  <main>
    <div class="section-hero">
      <div class="section-badge">SECTION 7 OF 15</div>
      <h1 class="section-title">Residence - Early</h1>
      <div class="section-meta">
        <span>‚Ä¢</span>
        <span>RESIDENCE</span>
        <span>‚Ä¢</span>
        <span>KEY COLLECTION</span>
      </div>
    </div>

    <div class="content-grid">
      <aside class="sidebar">
        <div class="toc">
          <h3>Contents</h3>
          <ul>
            <li><a href="#objectives" class="active">Objectives</a></li>
            <li><a href="#room-002">Room 002</a></li>
            <li><a href="#room-001">Room 001</a></li>
            <li><a href="#bookshelf-puzzle">Bookshelf Puzzle</a></li>
            <li><a href="#aqua-ring-access">Aqua Ring Access</a></li>
          </ul>

          <div class="section-nav">
            <h4>Navigate</h4>
            <a href="remake_guide_page_7.html" class="nav-link">‚Üê Section 6: Courtyard & Lisa's Hut</a>
            <a href="remake_guide_page_9.html" class="nav-link">Section 8: Neptune & Aqua Ring ‚Üí</a>
          </div>
        </div>
      </aside>

      <div class="main-content">
        <div class="objectives-box" id="objectives">
          <h3>Section Objectives</h3>
          <ul>
            <li>Navigate Rec Room and collect Red Book</li>
            <li>Survive tentacle encounters in hallway</li>
            <li>Collect keys from Room 001 and Room 002 bathrooms</li>
            <li>Solve bookshelf puzzle to access Aqua Ring</li>
            <li>Navigate box puzzle in flooded hallway</li>
          </ul>
        </div>

        <p>The Residence section is one of the most item-dense areas in the speedrun. Efficient routing and inventory management are critical here.</p>

        <div class="content-section" id="room-002">
          <h2>Room 002 Navigation</h2>
          
          <h3>Rec Room - Red Book</h3>
          
          <ol>
            <li>Go down the hallway into the Rec Room</li>
            <li>Grab the <strong>Red Book</strong> from the table</li>
            <li>Exit immediately</li>
          </ol>

          <div class="info-box">
            <div class="info-box-title">Spider Safety</div>
            <p>The spider at the door will only rarely attack you. Run straight through without hesitation and you'll avoid damage 95% of the time. The spider's attack is slow and telegraphed.</p>
          </div>
        </div>

        <div class="content-section" id="room-001">
          <h2>Room 002 and Room 001</h2>
          
          <h3>Tentacle Encounters</h3>
          
          <p>The hallway between rooms features tentacles that grab Jill. These encounters are unavoidable but deal minimal damage.</p>

          <div class="info-box">
            <div class="info-box-title">Tentacle Mechanics</div>
            <p><strong>Shake off technique:</strong> Spin the control stick or d-pad and mash confirm plus another face button simultaneously. The tentacle does no damage or fractional damage - there's no need for safety strategies.</p>
            <p style="margin-top: 0.75rem;">Jill will be able to tank the hits without going into Caution or Danger status.</p>
          </div>

          <h3>Room 002 - First Key</h3>
          
          <ol>
            <li>Shake off the tentacle on the way to Room 002</li>
            <li>Skip cutscenes and enter the bathroom</li>
            <li>Grab the <strong>001 Key</strong></li>
            <li>Leave back out of the room</li>
          </ol>

          <h3>Room 001 - Control Room Key</h3>
          
          <ol start="5">
            <li>Shake off the tentacle again in the hallway</li>
            <li>Go into Room 001's bathroom</li>
            <li>Grab the <strong>Control Room Key</strong></li>
            <li>Leave the bathroom</li>
          </ol>
        </div>

        <div class="content-section" id="inventory-management">
          <h2>Inventory Management Reminder</h2>
          
          <div class="info-box">
            <div class="info-box-title">Key Discarding</div>
            <p><strong>Important:</strong> When the game prompts you to discard keys after using them for the final time, always choose "Yes" to free up inventory space. Keys aren't automatically discarded when no longer needed, and keeping them wastes valuable inventory slots for upcoming items.</p>
            <p style="margin-top: 0.75rem;">This is especially critical in the Residence section where you'll collect multiple keys and need space for essential items like the Aqua Ring and other progression items.</p>
          </div>
        </div>

        <div class="content-section" id="bookshelf-puzzle">
          <h2>Bookshelf Puzzle</h2>
          
          <p>Return to Room 002 to access the bookshelf puzzle that leads to the Aqua Ring.</p>

          <h3>Puzzle Solution</h3>
          
          <ol>
            <li>Shake off the tentacle (third time) and return to Room 002</li>
            <li>Push the bookshelves in the room</li>
          </ol>

          <div class="info-box">
            <div class="info-box-title">Advanced Technique - Shelf Skip</div>
            <p>The left bookshelf can be skipped by beginning movement into it and gradually turning toward the right bookshelf. This saves approximately 2-3 seconds but requires precise analog stick control.</p>
            <p style="margin-top: 0.75rem;"><strong>Standard method:</strong> Push both shelves normally if you're not confident with the skip.</p>
          </div>

          <ol start="3">
            <li>Proceed down the ladder to the <strong>Aqua Ring</strong></li>
          </ol>
        </div>

        <div class="content-section" id="aqua-ring-access">
          <h2>Aqua Ring and Box Puzzle</h2>
          
          <h3>Flooded Hallway Navigation</h3>
          
          <p>The Aqua Ring area features a flooded hallway with boxes that must be pushed to create a path.</p>

          <ol>
            <li>Push the boxes into the water to create a path</li>
            <li>Proceed into the shark room (Neptune's area)</li>
          </ol>

          <div class="info-box warning">
            <div class="info-box-title">Safety Herb Available</div>
            <p>If you are concerned about taking a shark bite in the next section, pick up the Green Herb before entering the Aqua Ring. However, this costs inventory space.</p>
            <p style="margin-top: 0.75rem;">Most runners skip the herb and tank the shark bite if it occurs, as it's only a quick bite and won't put you into Danger.</p>
          </div>

          <h3>Current Progress</h3>
          
          <p>You've now collected:</p>
          <ul style="margin-left: 2rem; margin-bottom: 1.5rem;">
            <li>Red Book (for later puzzle)</li>
            <li>Control Room Key</li>
          </ul>

          <div class="info-box">
            <div class="info-box-title">What's Next</div>
            <p>Section 9 covers the shark room encounter with Neptune, the Control Room puzzle for draining water, and retrieving the Gallery Key. This includes one of the run's most dangerous skip opportunities.</p>
          </div>

          <h3>Practice Tips</h3>
          
          <p><strong>Tentacle Shaking:</strong> Practise the spin and button mash technique. The faster you shake free, the less time you lose to these encounters.</p>
          <p><strong>Room Routing:</strong> Memorise the path: Rec Room ‚Üí 002 ‚Üí 001 ‚Üí back to 002 ‚Üí ladder. Any backtracking or wrong turns costs significant time.</p>
          <p><strong>Bookshelf Skip:</strong> Only attempt the advanced skip if you've practiced it. Missing the skip and having to correct wastes more time than just pushing both shelves normally.</p>
        </div>

        <div class="page-nav">
          <a href="remake_guide_page_7.html" class="page-nav-btn">
            <span>‚Üê</span>
            <span>Section 6: Courtyard & Lisa's Hut</span>
          </a>
          <a href="remake_guide_page_9.html" class="page-nav-btn">
            <span>Section 8: Neptune & Aqua Ring</span>
            <span>‚Üí</span>
          </a>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Blood drip animation
    const bloodDripsContainer = document.getElementById('bloodDrips');
    for (let i = 0; i < 5; i++) {
      const drip = document.createElement('div');
      drip.className = 'blood-drip';
      drip.style.left = Math.random() * 100 + '%';
      drip.style.animationDelay = Math.random() * 3 + 's';
      drip.style.animationDuration = (Math.random() * 2 + 2) + 's';
      bloodDripsContainer.appendChild(drip);
    }

    window.addEventListener('scroll', () => {
      const winScroll = document.documentElement.scrollTop;
      const height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      document.getElementById('progressBar').style.width = (winScroll / height) * 100 + '%';
    });

    window.addEventListener('scroll', () => {
      const header = document.getElementById('header');
      header.classList.toggle('scrolled', window.scrollY > 100);
    });

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
          target.scrollIntoView({ behavior: 'smooth', block: 'start' });
          document.querySelectorAll('.toc a').forEach(link => link.classList.remove('active'));
          this.classList.add('active');
        }
      });
    });

    const sections = document.querySelectorAll('.content-section');
    const tocLinks = document.querySelectorAll('.toc a');

    window.addEventListener('scroll', () => {
      let current = '';
      sections.forEach(section => {
        if (scrollY >= section.offsetTop - 150) current = section.getAttribute('id');
      });

      tocLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === '#' + current) link.classList.add('active');
      });
    });
  

// Hamburger menu toggle
(function() {
  const hamburger = document.getElementById('hamburger');
  const nav = document.querySelector('.nav');
  
  if (hamburger && nav) {
    hamburger.addEventListener('click', function(e) {
      e.stopPropagation();
      hamburger.classList.toggle('active');
      nav.classList.toggle('active');
      hamburger.setAttribute('aria-expanded', nav.classList.contains('active'));
    });
    
    nav.querySelectorAll('a:not(.dropdown-toggle)').forEach(function(link) {
      link.addEventListener('click', function() {
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
      });
    });
    
    nav.querySelectorAll('.dropdown-toggle').forEach(function(toggle) {
      toggle.addEventListener('click', function(e) {
        e.preventDefault();
        e.stopPropagation();
        this.parentElement.classList.toggle('open');
      });
    });
    
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape' && nav.classList.contains('active')) {
        hamburger.classList.remove('active');
        nav.classList.remove('active');
        hamburger.setAttribute('aria-expanded', 'false');
      }
    });
  }
})();

</script>

  <footer class="footer">
    <div class="footer-content">
      <div class="footer-info">
        <p>Original Guide by Deccyf</p>
        <p>¬© 2025 Wheel of Struggle Community Speedrun Guide ‚Ä¢ All Rights Reserved</p>
      </div>
      <div class="footer-buttons">
        <a href="https://discord.com/invite/8RVRE33WfN" class="footer-btn discord-btn" target="_blank">
          <img src="Logos/e5d0b9e74328b8ce389bd8dd7f4e56b0.png" alt="Discord" class="footer-icon discord-logo">
          Discord
        </a>
        <a href="https://wheelofstruggle.com" class="footer-btn website-btn" target="_blank">
          <img src="Logos/WoS_Discord_Colour_V2.png" alt="Wheel of Struggle" class="footer-icon website-logo">
          Website
        </a>
      </div>
    </div>
  </footer>

  <script>
    // ENHANCED MUSIC CONTROL SYSTEM
    let backgroundMusic = null;
    let musicControlPanel = null;
    const musicFiles = ['01 R.E. 1 Save Room- Safe Haven.mp3'];

    function createMusicControl() {
      musicControlPanel = document.createElement('div');
      musicControlPanel.id = 'musicControlPanel';
      musicControlPanel.innerHTML = `
        <div class="music-control-header">
          <span class="music-icon">üéµ</span>
          <span class="music-title">Background Music</span>
          <button id="musicCloseBtn" class="music-close-btn">√ó</button>
        </div>
        <div class="music-control-content">
          <button id="musicToggleBtn" class="music-toggle-btn">
            <span id="musicToggleIcon">‚ñ∂Ô∏è</span>
            <span id="musicToggleText">Play</span>
          </button>
          <div class="music-volume-container">
            <span class="music-volume-label">Volume</span>
            <input type="range" id="musicVolumeSlider" min="0" max="100" value="30" class="music-volume-slider">
            <span id="musicVolumeValue">30</span>
          </div>
          <div class="music-status" id="musicStatus">Ready to play</div>
        </div>
      `;
      
      musicControlPanel.style.cssText = `
        position: fixed; bottom: 20px; right: 20px; width: 250px; background: rgba(13, 13, 13, 0.95);
        border: 2px solid var(--re-blood); border-radius: 15px; box-shadow: 0 8px 30px rgba(139, 0, 0, 0.4);
        backdrop-filter: blur(20px); z-index: 1000; opacity: 0; transform: translateY(20px);
        transition: all 0.3s ease; font-family: 'Barlow', sans-serif;
      `;

      const style = document.createElement('style');
      style.textContent = `
        .music-control-header { background: var(--re-blood); color: white; padding: 12px 15px;
          border-radius: 13px 13px 0 0; display: flex; align-items: center; justify-content: space-between;
          font-weight: 700; font-size: 14px; }
        .music-icon { font-size: 16px; }
        .music-close-btn { background: none; border: none; color: white; font-size: 20px;
          cursor: pointer; padding: 0; width: 25px; height: 25px; border-radius: 50%;
          display: flex; align-items: center; justify-content: center; transition: background 0.2s ease; }
        .music-close-btn:hover { background: rgba(255, 255, 255, 0.2); }
        .music-control-content { padding: 15px; }
        .music-toggle-btn { width: 100%; background: rgba(139, 0, 0, 0.2); border: 2px solid var(--re-blood);
          color: white; padding: 12px 15px; border-radius: 25px; cursor: pointer; display: flex;
          align-items: center; justify-content: center; gap: 8px; font-weight: 600; font-size: 14px;
          margin-bottom: 15px; transition: all 0.3s ease; }
        .music-toggle-btn:hover { background: var(--re-blood); transform: translateY(-2px);
          box-shadow: 0 4px 15px rgba(139, 0, 0, 0.4); }
        .music-volume-container { display: flex; align-items: center; gap: 10px; margin-bottom: 15px; }
        .music-volume-label { color: var(--re-gray); font-size: 12px; font-weight: 600; min-width: 50px; }
        .music-volume-slider { flex: 1; height: 6px; background: rgba(139, 0, 0, 0.3);
          border-radius: 3px; outline: none; cursor: pointer; }
        .music-volume-slider::-webkit-slider-thumb { appearance: none; width: 18px; height: 18px;
          background: var(--re-blood); border-radius: 50%; cursor: pointer; box-shadow: 0 0 8px rgba(139, 0, 0, 0.6); }
        .music-volume-slider::-moz-range-thumb { width: 18px; height: 18px; background: var(--re-blood);
          border-radius: 50%; cursor: pointer; border: none; box-shadow: 0 0 8px rgba(139, 0, 0, 0.6); }
        #musicVolumeValue { color: var(--re-white); font-weight: 600; font-size: 12px; min-width: 30px; text-align: right; }
        .music-status { color: var(--re-gray); font-size: 11px; font-weight: 500; text-align: center;
          padding: 5px; background: rgba(139, 0, 0, 0.1); border-radius: 8px; margin-top: 10px; }
      `;
      document.head.appendChild(style);
      document.body.appendChild(musicControlPanel);
      
      setTimeout(() => { musicControlPanel.style.opacity = '1'; musicControlPanel.style.transform = 'translateY(0)'; }, 100);

      setupMusicControlEvents();
    }

    function setupMusicControlEvents() {
      document.getElementById('musicToggleBtn').addEventListener('click', toggleMusic);
      document.getElementById('musicVolumeSlider').addEventListener('input', updateVolume);
      document.getElementById('musicCloseBtn').addEventListener('click', hideMusicControl);
      document.getElementById('musicVolumeValue').textContent = document.getElementById('musicVolumeSlider').value;
      updateVolume();
    }

    function toggleMusic() {
      const toggleIcon = document.getElementById('musicToggleIcon');
      const toggleText = document.getElementById('musicToggleText');
      const status = document.getElementById('musicStatus');
      if (!backgroundMusic) { startBackgroundMusic(); toggleIcon.textContent = '‚è∏Ô∏è'; toggleText.textContent = 'Pause';
        status.textContent = 'Playing Resident Evil Theme'; status.style.color = 'var(--re-green)'; }
      else if (backgroundMusic.paused) { backgroundMusic.play(); toggleIcon.textContent = '‚è∏Ô∏è'; toggleText.textContent = 'Pause';
        status.textContent = 'Playing Resident Evil Theme'; status.style.color = 'var(--re-green)'; }
      else { backgroundMusic.pause(); toggleIcon.textContent = '‚ñ∂Ô∏è'; toggleText.textContent = 'Play';
        status.textContent = 'Music paused'; status.style.color = 'var(--re-gray)'; }
    }

    function updateVolume() {
      const volumeSlider = document.getElementById('musicVolumeSlider');
      const volumeValue = document.getElementById('musicVolumeValue');
      const volume = parseInt(volumeSlider.value) / 100;
      volumeValue.textContent = volumeSlider.value;
      if (backgroundMusic) backgroundMusic.volume = volume;
      localStorage.setItem('musicVolume', volumeSlider.value);
    }

    function startBackgroundMusic() {
      if (backgroundMusic) return;
      backgroundMusic = new Audio();
      backgroundMusic.src = musicFiles[0];
      backgroundMusic.loop = true;
      const savedVolume = localStorage.getItem('musicVolume') || '30';
      backgroundMusic.volume = parseInt(savedVolume) / 100;
      document.getElementById('musicVolumeSlider').value = savedVolume;
      document.getElementById('musicVolumeValue').textContent = savedVolume;
      backgroundMusic.play().then(() => {
        document.getElementById('musicStatus').textContent = 'Playing Resident Evil Theme';
        document.getElementById('musicStatus').style.color = 'var(--re-green)';
        document.getElementById('musicToggleIcon').textContent = '‚è∏Ô∏è';
        document.getElementById('musicToggleText').textContent = 'Pause';
      }).catch(() => {
        document.getElementById('musicStatus').textContent = 'Click play to start music';
        document.getElementById('musicStatus').style.color = 'var(--re-gray)';
      });
      backgroundMusic.addEventListener('ended', () => { backgroundMusic.currentTime = 0; backgroundMusic.play(); });
      backgroundMusic.addEventListener('error', (e) => {
        document.getElementById('musicStatus').textContent = 'Music file not found';
        document.getElementById('musicStatus').style.color = 'var(--re-blood)';
      });
    }

    function hideMusicControl() {
      if (musicControlPanel) {
        musicControlPanel.style.opacity = '0'; musicControlPanel.style.transform = 'translateY(20px)';
        setTimeout(() => { if (musicControlPanel && musicControlPanel.parentNode) musicControlPanel.parentNode.removeChild(musicControlPanel); musicControlPanel = null; }, 300);
      }
    }

    function showMusicControlButton() {
      const musicButton = document.createElement('div');
      musicButton.id = 'musicControlButton';
      musicButton.innerHTML = 'üéµ Music';
      musicButton.style.cssText = `position: fixed; bottom: 20px; right: 20px; background: rgba(139, 0, 0, 0.8);
        color: var(--re-white); padding: 12px 18px; border-radius: 25px; cursor: pointer; font-size: 14px; font-weight: 600;
        z-index: 1000; transition: all 0.3s ease; box-shadow: 0 4px 15px rgba(139, 0, 0, 0.3); border: 2px solid rgba(139, 0, 0, 0.3);`;
      
      musicButton.addEventListener('mouseenter', () => { musicButton.style.background = 'var(--re-blood)'; musicButton.style.transform = 'scale(1.05)'; musicButton.style.boxShadow = '0 6px 20px rgba(139, 0, 0, 0.5)'; });
      musicButton.addEventListener('mouseleave', () => { musicButton.style.background = 'rgba(139, 0, 0, 0.8)'; musicButton.style.transform = 'scale(1)'; musicButton.style.boxShadow = '0 4px 15px rgba(139, 0, 0, 0.3)'; });
      musicButton.addEventListener('click', () => { createMusicControl(); musicButton.remove(); });
      document.body.appendChild(musicButton);
    }

    function initBackgroundMusic() {
      const musicInteracted = localStorage.getItem('musicInteracted') === 'true';
      if (!musicInteracted) {
        document.addEventListener('click', () => {
          localStorage.setItem('musicInteracted', 'true');
          document.getElementById('musicControlButton')?.remove();
          showMusicControlButton();
        }, { once: true });
      } else {
        showMusicControlButton();
      }
    }

    initBackgroundMusic();
    
    // MOBILE DROPDOWN NAVIGATION FIX
    (function() {
      const dropdown = document.querySelector('.dropdown');
      const dropdownToggle = document.querySelector('.dropdown-toggle');
      const dropdownMenu = document.querySelector('.dropdown-menu');
      if (!dropdown || !dropdownToggle || !dropdownMenu) return;
      function isMobile() { return window.innerWidth <= 768; }
      dropdownToggle.addEventListener('click', function(e) {
        if (isMobile()) { e.preventDefault(); e.stopPropagation(); dropdown.classList.toggle('open'); }
      });
      document.addEventListener('click', function(e) {
        if (isMobile() && !dropdown.contains(e.target)) dropdown.classList.remove('open');
      });
      dropdownMenu.querySelectorAll('a').forEach(link => {
        link.addEventListener('click', function() { if (isMobile()) dropdown.classList.remove('open'); });
      });
      let wasMobile = isMobile();
      window.addEventListener('resize', function() {
        const nowMobile = isMobile();
        if (wasMobile !== nowMobile) dropdown.classList.remove('open');
        wasMobile = nowMobile;
      });
    })();
  </script>
</body>
</html>
